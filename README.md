rewrite in rust go brrrr